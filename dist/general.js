!function(r,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.General=e():r.General=e()}(this,function(){return function(r){function e(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return r[t].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=r,e.c=n,e.i=function(r){return r},e.d=function(r,n,t){e.o(r,n)||Object.defineProperty(r,n,{configurable:!1,enumerable:!0,get:t})},e.n=function(r){var n=r&&r.__esModule?function(){return r.default}:function(){return r};return e.d(n,"a",n),n},e.o=function(r,e){return Object.prototype.hasOwnProperty.call(r,e)},e.p="/dist/",e(e.s=1)}([function(r,e,n){"use strict";var t=n(2);n.d(e,"a",function(){return o});var i=n(4),o=function(){function r(){var r=this;this.worker=new i,this.queue=[],this.currentJob=void 0,this.markerArray=new Float32Array(1e3*t.a),this.worker.onmessage=function(e){if(void 0!==r.currentJob){var n=r.currentJob,t=n.markers,i=n.resolve;r.recordResult(t,e.data),r.markerArray=e.data,r.currentJob=void 0,r.dequeue(),i()}}}return r.prototype.generalize=function(r,e,n,t,i){var o=this,a={bounds:r,pixelRatio:e,priorityGroups:n,sprites:t.sprites};return new Promise(function(r){o.queue.push({message:a,markers:i,resolve:r}),o.dequeue()})},r.prototype.clear=function(){this.queue=[]},r.prototype.pack=function(r){r.length*t.a>this.markerArray.length&&(this.markerArray=new Float32Array(r.length*t.a));for(var e=this.markerArray,n=0,i=0;n<r.length;n++,i+=t.a){var o=r[n],a=o.iconIndex,u=o.prevGroupIndex;this.markerArray[i+t.b.pixelPositionX]=o.pixelPosition[0],this.markerArray[i+t.b.pixelPositionY]=o.pixelPosition[1],e[i+t.b.groupIndex]=o.groupIndex,e[i+t.b.iconIndex]=void 0!==a?a:NaN,e[i+t.b.prevGroupIndex]=void 0!==u?u:NaN}},r.prototype.dequeue=function(){if(void 0===this.currentJob){var r=this.queue.shift();if(void 0!==r){this.pack(r.markers);var e=r.message;e.markers=this.markerArray,e.markerCount=r.markers.length,this.worker.postMessage(e,[e.markers.buffer]),this.currentJob=r}}},r.prototype.recordResult=function(r,e){for(var n=0,i=0;n<r.length;n++,i+=t.a){var o=e[i+t.b.iconIndex],a=e[i+t.b.prevGroupIndex];r[n].iconIndex=o!==o?void 0:o,r[n].prevGroupIndex=a!==a?void 0:a}},r}()},function(r,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var t=n(0);n.d(e,"General",function(){return t.a})},function(r,e,n){"use strict";n.d(e,"b",function(){return t}),n.d(e,"a",function(){return i});var t={pixelPositionX:0,pixelPositionY:1,groupIndex:2,iconIndex:3,prevGroupIndex:4},i=Object.keys(t).length},function(r,e){var n=window.URL||window.webkitURL;r.exports=function(r,e){try{try{var t;try{var i=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;t=new i,t.append(r),t=t.getBlob()}catch(e){t=new Blob([r])}return new Worker(n.createObjectURL(t))}catch(e){return new Worker("data:application/javascript,"+encodeURIComponent(r))}}catch(r){if(!e)throw Error("Inline worker is not supported");return new Worker(e)}}},function(r,e,n){r.exports=function(){return n(3)('!function(n){function r(i){if(e[i])return e[i].exports;var t=e[i]={i:i,l:!1,exports:{}};return n[i].call(t.exports,t,t.exports,r),t.l=!0,t.exports}var e={};r.m=n,r.c=e,r.i=function(n){return n},r.d=function(n,e,i){r.o(n,e)||Object.defineProperty(n,e,{configurable:!1,enumerable:!0,get:i})},r.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return r.d(e,"a",e),e},r.o=function(n,r){return Object.prototype.hasOwnProperty.call(n,r)},r.p="/dist/",r(r.s=1)}([function(n,r,e){"use strict";function i(n){for(var r=n.bounds,e=n.pixelRatio,i=n.priorityGroups,p=n.sprites,v=n.markers,d=n.markerCount,l=1+(r.maxX-r.minX>>3)<<3,X=r.maxY-r.minY,Y=l*X+8>>3,b=new Uint8Array(Y),g=new Uint8Array(Y),y=new Uint8Array(Y),I=0;I<d;I++){var P=v[I*m.a+m.b.prevGroupIndex],h=v[I*m.a+m.b.pixelPositionX],G=v[I*m.a+m.b.pixelPositionY];if(!a(P)){var O=i[P],j=O.iconIndex,k=O.margin,w=O.degradation,_=p[j];if(!_)continue;var A=_.size,M=_.anchor,U=_.pixelDensity;s(f,l,X,e,A,M,U,h,G,k),u(f)||o(b,l,f),s(c,l,X,e,A,M,U,h,G,w),u(c)||o(y,l,c)}}for(var I=0;I<i.length;I++){var z=i[I],D=z.safeZone,j=z.iconIndex,k=z.margin,w=z.degradation,_=p[j];if(_){var A=_.size,M=_.anchor,U=_.pixelDensity;g.set(y);for(var C=0;C<d;C++){var R=C*m.a,Z=v[R+m.b.groupIndex],P=v[R+m.b.prevGroupIndex],h=v[R+m.b.pixelPositionX],G=v[R+m.b.pixelPositionY];Z>I||!a(P)||(s(f,l,X,e,A,M,U,h,G,k),u(f)||Z===I&&t(g,l,f)||(s(x,l,X,e,A,M,U,h,G,D),u(x)||t(b,l,x)||(s(c,l,X,e,A,M,U,h,G,w),o(b,l,f),o(y,l,c),v[R+m.b.iconIndex]=j,v[R+m.b.prevGroupIndex]=I)))}}}}function t(n,r,e){for(var i=e.minX,t=e.minY,o=e.maxX,a=e.maxY,u=t;u<a;u++){var s=u*r+i>>3,m=u*r+o>>3,x=0;if(s===m)x=n[s]&255>>(7&i)&255<<8-(7&o);else{x=n[s]&255>>(7&i);for(var f=s+1;f<m;f++)x=n[f]|x;x=n[m]&255<<8-(7&o)|x}if(0!==x)return!0}return!1}function o(n,r,e){for(var i=e.minX,t=e.minY,o=e.maxX,a=e.maxY,u=t;u<a;u++){var s=u*r+i>>3,m=u*r+o>>3;if(s===m)n[s]=n[s]|255>>(7&i)&255<<8-(7&o);else{n[s]=n[s]|255>>(7&i);for(var x=s+1;x<m;x++)n[x]=255;n[m]=n[m]|255<<8-(7&o)}}}function a(n){return n!==n}function u(n){return n.minX===n.maxX||n.minY===n.maxY}function s(n,r,e,i,t,o,a,u,s,m){var x=i/a,f=u*i-t[0]*x*o[0]-m|0,c=s*i-t[1]*x*o[1]-m|0,p=u*i+t[0]*x*(1-o[0])+m|0,v=s*i+t[1]*x*(1-o[1])+m|0;n.minX=f>0?f<r?f:r:0,n.minY=c>0?c<e?c:e:0,n.maxX=p>0?p<r?p:r:0,n.maxY=v>0?v<e?v:e:0}var m=e(2);r.a=i;var x={minX:0,minY:0,maxX:0,maxY:0},f={minX:0,minY:0,maxX:0,maxY:0},c={minX:0,minY:0,maxX:0,maxY:0}},function(n,r,e){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=e(0);onmessage=function(n){var r=n.data;e.i(i.a)(r),postMessage(r.markers)}},function(n,r,e){"use strict";e.d(r,"b",function(){return i}),e.d(r,"a",function(){return t});var i={pixelPositionX:0,pixelPositionY:1,groupIndex:2,iconIndex:3,prevGroupIndex:4},t=Object.keys(i).length}]);\n//# sourceMappingURL=dde090990a6feb572c38.worker.js.map',null)}}])});
//# sourceMappingURL=general.js.map